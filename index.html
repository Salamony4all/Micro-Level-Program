<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alshaya Enterprises â„¢ - Micro level Program</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --background: 240 14% 96%;
            --foreground: 210 29% 24%;
            --card: 0 0% 100%;
            --card-foreground: 210 29% 24%;
            --popover: 0 0% 100%;
            --popover-foreground: 210 29% 24%;
            --primary: 210 29% 24%;
            --primary-foreground: 0 0% 98%;
            --secondary: 240 5% 90%;
            --secondary-foreground: 210 29% 24%;
            --muted: 240 5% 90%;
            --muted-foreground: 210 10% 45%;
            --accent: 207 70% 53%;
            --accent-foreground: 0 0% 98%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 0 0% 98%;
            --border: 240 5% 88%;
            --input: 240 5% 88%;
            --ring: 207 70% 53%;
            --radius: 0.5rem;
        }
        body {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: hsl(var(--card));
            color: hsl(var(--card-foreground));
            border-radius: var(--radius);
            border: 1px solid hsl(var(--border));
        }
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        .btn-primary:hover {
            background-color: hsl(var(--primary) / 0.9);
        }
        .btn-outline {
            border: 1px solid hsl(var(--input));
            background-color: transparent;
        }
        .btn-outline:hover {
            background-color: hsl(var(--accent));
            color: hsl(var(--accent-foreground));
        }
        .table-auto th, .table-auto td {
            border: 1px solid hsl(var(--border));
            padding: 0.5rem;
        }
        .table-auto th {
            background-color: hsl(var(--muted));
        }
        .input {
            border: 1px solid hsl(var(--input));
            background-color: hsl(var(--card));
            padding: 0.5rem;
            border-radius: 0.375rem;
        }
        .flatpickr-calendar {
            background-color: hsl(var(--popover));
            border-color: hsl(var(--border));
        }
        .flatpickr-day.selected {
            background-color: hsl(var(--primary));
            border-color: hsl(var(--primary));
        }
        .status-dropdown {
            min-width: 150px;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body class="antialiased">
    <div id="app" class="flex flex-col min-h-screen">
        <header class="p-4 border-b border-[hsl(var(--border))]">
            <div class="container mx-auto flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-8 w-8 text-[hsl(var(--primary))]">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                </svg>
                <div>
                    <h1 class="text-xl font-bold text-[hsl(var(--primary))]">Alshaya Enterprises â„¢</h1>
                    <p class="text-sm text-[hsl(var(--muted-foreground))]">Micro level Program / Action Plan</p>
                </div>
            </div>
        </header>
        <main class="flex-1 py-8 md:py-12">
            <div class="container mx-auto px-4 space-y-8" id="main-content">
                <!-- Project Details and Tables will be rendered here -->
            </div>
        </main>
        <footer class="p-4 border-t border-[hsl(var(--border))]">
            <div class="container mx-auto text-center text-sm text-[hsl(var(--muted-foreground))]">
                <p>Powered by GenAI. Extract tables from your documents with ease.</p>
            </div>
        </footer>
    </div>

    <script>
    const { jsPDF } = window.jspdf;
    const initialStaticData = {
        locations: [
            {
            location: 'NCSI Action Plan',
            tables: [
                {
                    title: 'Engineering',
                    headers: ['Main Activity', 'Activity/Item', 'Shop Drawing Submission Date', 'Shop Drawing Approval Date', 'Remarks'],
                    rows: [
                        ['Flooring', 'Marble', '', '', ''],
                        ['Flooring', 'Porcelain', '', '', ''],
                        ['Flooring', 'Tiles Carpet', '', '', ''],
                        ['Flooring', 'Custom Carpets', '', '', ''],
                        ['Wall Finishes', 'Wooden Cladding', '', '', ''],
                        ['Wall Finishes', 'Wall Paint', '', '', ''],
                        ['Wall Finishes', 'MCM Stones', '', '', ''],
                        ['Partitions', 'Gypsum Partition', '', '', ''],
                        ['Partitions', 'Glass Partition', '', '', ''],
                        ['Doors', 'Doors', '', '', ''],
                        ['Sanitary', 'Sanitary', '', '', ''],
                        ['Paint', 'Ceiling Paint', '', '', ''],
                        ['PA', 'Screens & PA Systems', '', '', ''],
                        ['Furniture', 'Customized Furniture', '', '', ''],
                        ['Furniture', 'Furniture', '', '', ''],
                        ['Planters', 'Planters', '', '', ''],
                    ],
                },
                {
                    title: 'Procurement',
                    headers: ['Main Activity', 'Activity/Item', 'Material Submittal Date', 'Procurement Status', 'Remarks'],
                    rows: [
                        ['Flooring', 'Marble', '', 'ðŸŸ¡ Pending', ''],
                        ['Flooring', 'Porcelain', '', 'ðŸŸ¡ Pending', ''],
                        ['Flooring', 'Tiles Carpet', '', 'ðŸŸ¡ Pending', ''],
                        ['Flooring', 'Custom Carpets', '', 'ðŸŸ¡ Pending', ''],
                        ['Wall Finishes', 'Wooden Cladding', '', 'ðŸŸ¡ Pending', ''],
                        ['Wall Finishes', 'Wall Paint', '', 'ðŸŸ¡ Pending', ''],
                        ['Wall Finishes', 'MCM Stones', '', 'ðŸŸ¡ Pending', ''],
                        ['Partitions', 'Gypsum Partition', '', 'ðŸŸ¡ Pending', ''],
                        ['Partitions', 'Glass Partition', '', 'ðŸŸ¡ Pending', ''],
                        ['Doors', 'Doors', '', 'ðŸŸ¡ Pending', ''],
                        ['Sanitary', 'Sanitary', '', 'ðŸŸ¡ Pending', ''],
                        ['Paint', 'Ceiling Paint', '', 'ðŸŸ¡ Pending', ''],
                        ['PA', 'Screens & PA Systems', '', 'ðŸŸ¡ Pending', ''],
                        ['Furniture', 'Customized Furniture', '', 'ðŸŸ¡ Pending', ''],
                        ['Furniture', 'Furniture', '', 'ðŸŸ¡ Pending', ''],
                        ['Planters', 'Planters', '', 'ðŸŸ¡ Pending', ''],
                    ],
                },
                {
                    title: 'Execution',
                    headers: ['Main Activity', 'Activity/Item', 'Execution Start Date', 'Execution Finish Date', 'Remarks'],
                    rows: [
                        ['Flooring', 'Marble', '', '', ''],
                        ['Flooring', 'Porcelain', '', '', ''],
                        ['Flooring', 'Tiles Carpet', '', '', ''],
                        ['Flooring', 'Custom Carpets', '', '', ''],
                        ['Wall Finishes', 'Wooden Cladding', '', '', ''],
                        ['Wall Finishes', 'Wall Paint', '', '', ''],
                        ['Wall Finishes', 'MCM Stones', '', '', ''],
                        ['Partitions', 'Gypsum Partition', '', '', ''],
                        ['Partitions', 'Glass Partition', '', '', ''],
                        ['Doors', 'Doors', '', '', ''],
                        ['Sanitary', 'Sanitary', '', '', ''],
                        ['Paint', 'Ceiling Paint', '', '', ''],
                        ['PA', 'Screens & PA Systems', '', '', ''],
                        ['Furniture', 'Customized Furniture', '', '', ''],
                        ['Furniture', 'Furniture', '', '', ''],
                        ['Planters', 'Planters', '', '', ''],
                    ],
                },
            ],
            },
        ],
    };

    let appData = null;
    let projectDetailsData = null;
    const tableTitlesOrder = ["Engineering", "Procurement", "Execution"];

    function formatDate(date) {
        const d = new Date(date);
        const year = d.getFullYear();
        let month = '' + (d.getMonth() + 1);
        let day = '' + d.getDate();
        if (month.length < 2) month = '0' + month;
        if (day.length < 2) day = '0' + day;
        return [year, month, day].join('-');
    }

    function initializeData() {
        // Deep copy of initial data
        appData = JSON.parse(JSON.stringify(initialStaticData));

        // Initialize dates
        appData.locations.forEach(loc => {
            loc.tables.forEach(table => {
                const lowerTitle = table.title.toLowerCase();
                if (lowerTitle === "engineering" || lowerTitle === "execution") {
                    const dateColumnIndices = table.headers
                        .map((h, i) => (h.toLowerCase().includes('date') ? i : -1))
                        .filter(i => i !== -1);
                    
                    if (dateColumnIndices.length > 0) {
                        table.rows.forEach(row => {
                            dateColumnIndices.forEach(index => {
                                if (!row[index]) {
                                    row[index] = formatDate(new Date());
                                }
                            });
                        });
                    }
                }
            });
        });

        // Initialize project details
        projectDetailsData = JSON.parse(localStorage.getItem('projectDetails')) || {
            date: formatDate(new Date()),
            referenceNumber: 'AE/MLP/001',
            projectName: initialStaticData.locations[0]?.location || 'New Project',
            clientName: 'Client Name',
            clientContactPerson: 'Contact Person',
        };
    }
    
    function renderProjectDetails() {
        const container = document.getElementById('main-content');
        
        const detailsCard = document.createElement('div');
        detailsCard.className = 'card w-full max-w-7xl mx-auto shadow-lg p-6';
        detailsCard.innerHTML = `
            <h2 class="text-3xl font-semibold mb-6">Project Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="space-y-2">
                    <label class="font-medium">Date</label>
                    <input type="text" id="project-date" class="input w-full" value="${projectDetailsData.date}">
                </div>
                <div class="space-y-2">
                    <label class="font-medium">Reference Number</label>
                    <input type="text" id="project-ref" class="input w-full" value="${projectDetailsData.referenceNumber}">
                </div>
                <div class="space-y-2">
                    <label class="font-medium">Project Name</label>
                    <input type="text" id="project-name" class="input w-full" value="${projectDetailsData.projectName}">
                </div>
                <div class="space-y-2">
                    <label class="font-medium">Client Name</label>
                    <input type="text" id="project-client" class="input w-full" value="${projectDetailsData.clientName}">
                </div>
                <div class="space-y-2">
                    <label class="font-medium">Client Contact Person</label>
                    <input type="text" id="project-contact" class="input w-full" value="${projectDetailsData.clientContactPerson}">
                </div>
            </div>
        `;

        container.appendChild(detailsCard);
        
        // Add event listeners
        flatpickr("#project-date", {
            dateFormat: "Y-m-d",
            onChange: (selectedDates, dateStr) => handleProjectDetailChange('date', dateStr)
        });
        document.getElementById('project-ref').addEventListener('change', (e) => handleProjectDetailChange('referenceNumber', e.target.value));
        document.getElementById('project-name').addEventListener('change', (e) => handleProjectDetailChange('projectName', e.target.value));
        document.getElementById('project-client').addEventListener('change', (e) => handleProjectDetailChange('clientName', e.target.value));
        document.getElementById('project-contact').addEventListener('change', (e) => handleProjectDetailChange('clientContactPerson', e.target.value));
    }
    
    function handleProjectDetailChange(field, value) {
        projectDetailsData[field] = value;
        localStorage.setItem('projectDetails', JSON.stringify(projectDetailsData));
    }
    
    function renderTables() {
        const container = document.getElementById('main-content');
        
        const tablesCard = document.createElement('div');
        tablesCard.className = 'card w-full max-w-7xl mx-auto shadow-lg mt-8';
        tablesCard.innerHTML = `
            <div class="p-6">
                <div class="flex flex-wrap items-center justify-between gap-4">
                    <div>
                        <h2 class="text-3xl font-semibold">Micro Level Program</h2>
                        <p class="text-sm text-[hsl(var(--muted-foreground))]">Generated Micro Level Program from 'NCSI Action Plan 2-9-2025 1.pdf'. You can edit the data below.</p>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button id="reset-btn" class="btn btn-outline">Reset Data</button>
                        <button id="pdf-btn" class="btn btn-outline">Download as PDF</button>
                        <button id="csv-btn" class="btn btn-primary">Download as CSV</button>
                    </div>
                </div>
            </div>
            <div class="p-6 pt-0 space-y-8" id="tables-container"></div>
        `;
        container.appendChild(tablesCard);
        
        document.getElementById('reset-btn').addEventListener('click', () => {
            if(confirm('Are you sure you want to reset all data?')) {
                localStorage.removeItem('projectDetails');
                main();
            }
        });
        document.getElementById('pdf-btn').addEventListener('click', downloadAllAsPdf);
        document.getElementById('csv-btn').addEventListener('click', downloadAllAsCsv);

        const tablesContainer = document.getElementById('tables-container');
        appData.locations.forEach((loc, locIndex) => {
            const locCard = document.createElement('div');
            locCard.className = 'p-4 border border-[hsl(var(--border))] rounded-lg';
            locCard.innerHTML = `
                <div class="p-4">
                    <div class="flex items-center gap-2">
                      <span class="text-xl font-semibold">Location / Area / Zone:</span>
                      <input type="text" class="text-xl font-semibold border-0 border-b-2 rounded-none shadow-none focus:outline-none focus:ring-0 focus:border-blue-500" value="${loc.location}" onchange="handleLocationChange(${locIndex}, this.value)">
                    </div>
                </div>
                <div class="p-4 pt-0 space-y-6">
                    ${loc.tables.sort((a,b) => tableTitlesOrder.indexOf(a.title) - tableTitlesOrder.indexOf(b.title)).map((table, tableOrderIndex) => `
                        <div class="p-4 border border-[hsl(var(--border))] rounded-lg">
                            <h3 class="text-lg font-semibold mb-4">${table.title}</h3>
                            <div class="overflow-x-auto relative">
                                <table class="w-full text-sm text-left table-auto" id="table-${locIndex}-${table.title.toLowerCase()}">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            ${table.headers.map(h => `<th>${h}</th>`).join('')}
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${table.rows.map((row, rowIndex) => createTableRow(row, rowIndex, locIndex, table.title)).join('')}
                                    </tbody>
                                </table>
                            </div>
                            <div class="flex justify-end mt-4">
                                <button class="btn btn-outline text-xs" onclick="handleAddRow(${locIndex}, '${table.title}')">Add Row</button>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            tablesContainer.appendChild(locCard);
        });
        
        // Re-initialize date pickers for any newly rendered date inputs
        document.querySelectorAll('.date-picker-cell-input').forEach(input => {
            if (!input._flatpickr) { // Prevent re-initialization
                flatpickr(input, {
                    dateFormat: "Y-m-d",
                });
            }
        });
    }

    function createTableRow(row, rowIndex, locIndex, tableTitle) {
        const table = appData.locations[locIndex].tables.find(t => t.title === tableTitle);
        const originalTableIndex = initialStaticData.locations[locIndex].tables.findIndex(t => t.title === tableTitle);
        const initialRowsForLocationCount = initialStaticData.locations[0].tables.find(t => t.title === "Engineering")?.rows.length || 0;

        return `
            <tr data-row-index="${rowIndex}">
                ${row.map((cell, colIndex) => {
                    const header = table.headers[colIndex];
                    const lowerHeader = header.toLowerCase();
                    const lowerTableTitle = tableTitle.toLowerCase();
                    
                    if ((lowerTableTitle === "engineering" || lowerTableTitle === "execution") && lowerHeader.includes('date')) {
                        return `<td><input type="text" class="input w-full date-picker-cell-input" value="${cell || ''}" onchange="handleCellChange(${locIndex}, '${tableTitle}', ${rowIndex}, ${colIndex}, this.value)"></td>`;
                    }
                    if (lowerTableTitle === "procurement" && lowerHeader.includes('status')) {
                        const options = ["ðŸŸ¢ Completed", "ðŸŸ¡ Pending", "ðŸŸ  In Progress", "ðŸ”´ Delayed"];
                        const currentStatus = options.find(opt => cell?.includes(opt.split(' ')[1])) || "ðŸŸ¡ Pending";
                        return `<td>
                                    <select class="input w-full status-dropdown" onchange="handleCellChange(${locIndex}, '${tableTitle}', ${rowIndex}, ${colIndex}, this.value)">
                                        ${options.map(opt => `<option value="${opt}" ${opt === currentStatus ? 'selected' : ''}>${opt}</option>`).join('')}
                                    </select>
                                </td>`;
                    }
                    if ((lowerHeader.includes('main activity') || lowerHeader.includes('activity/item')) && rowIndex < initialRowsForLocationCount) {
                        return `<td class="bg-gray-50">${cell || ''}</td>`;
                    }
                    return `<td contenteditable="true" class="focus:bg-blue-100" onblur="handleCellChange(${locIndex}, '${tableTitle}', ${rowIndex}, ${colIndex}, this.innerText)">${cell || ''}</td>`;
                }).join('')}
                <td>
                    <button class="text-red-500 hover:text-red-700" onclick="handleDeleteRow(${locIndex}, '${tableTitle}', ${rowIndex})">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                    </button>
                </td>
            </tr>
        `;
    }

    window.handleLocationChange = (locIndex, value) => {
        appData.locations[locIndex].location = value;
    }

    window.handleCellChange = (locIndex, tableTitle, rowIndex, colIndex, value) => {
        const table = appData.locations[locIndex].tables.find(t => t.title === tableTitle);
        if(table) {
            table.rows[rowIndex][colIndex] = value;
        }
    }

    window.handleAddRow = (locIndex, tableTitle) => {
        const table = appData.locations[locIndex].tables.find(t => t.title === tableTitle);
        if(table) {
            const newRow = Array(table.headers.length).fill('');
            const lowerTitle = table.title.toLowerCase();
            if (lowerTitle === "engineering" || lowerTitle === "execution") {
                table.headers.forEach((header, index) => {
                    if (header.toLowerCase().includes('date')) newRow[index] = formatDate(new Date());
                });
            }
            if (lowerTitle === "procurement") {
                table.headers.forEach((header, index) => {
                    if (header.toLowerCase().includes('status')) newRow[index] = 'ðŸŸ¡ Pending';
                });
            }
            table.rows.push(newRow);
            rerenderLocation(locIndex);
        }
    }
    
    window.handleDeleteRow = (locIndex, tableTitle, rowIndex) => {
        const table = appData.locations[locIndex].tables.find(t => t.title === tableTitle);
        if(table) {
            table.rows.splice(rowIndex, 1);
            rerenderLocation(locIndex);
        }
    }
    
    function rerenderLocation(locIndex) {
        // This is a simplified re-render. A more robust solution would use a virtual DOM.
        const mainContent = document.getElementById('main-content');
        mainContent.innerHTML = '';
        renderProjectDetails();
        renderTables();
    }
    
    function getCleanFileName() {
        const fileName = "NCSI Action Plan 2-9-2025 1.pdf";
        return fileName.substring(0, fileName.lastIndexOf('.')).replace(/[^a-z0-9]/gi, '_').toLowerCase();
    }
    
    function downloadAllAsCsv() {
        let csvContent = '';
        appData.locations.forEach((loc) => {
            csvContent += `Location: ${loc.location}\n\n`;
            loc.tables.forEach(table => {
                csvContent += `${table.title}\n`;
                csvContent += table.headers.join(',') + '\n';
                csvContent += table.rows.map(row =>
                    row.map(cell => `"${String(cell || '').replace(/"/g, '""')}"`).join(',')
                ).join('\n') + '\n\n';
            });
        });

        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', `${getCleanFileName()}_all_tables.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    
    function downloadAllAsPdf() {
        const doc = new jsPDF({ orientation: 'portrait' });
        const cleanFileName = getCleanFileName();
        let startY = 10;
        
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(10);
        doc.text("Alshaya Enterprises â„¢", (doc.internal.pageSize.getWidth() / 2), startY, { align: 'center' });
        startY += 5;
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(8);
        doc.text("Micro level Program / Action Plan", (doc.internal.pageSize.getWidth() / 2), startY, { align: 'center' });
        startY += 5;

        const details = [
            [`Date: ${projectDetailsData.date}`, `Reference No: ${projectDetailsData.referenceNumber}`],
            [`Project Name: ${projectDetailsData.projectName}`, `Client Name: ${projectDetailsData.clientName}`],
            [`Client Contact Person: ${projectDetailsData.clientContactPerson}`, '']
        ];

        doc.autoTable({
            body: details,
            startY: startY,
            theme: 'plain',
            styles: { fontSize: 6, cellPadding: 0.5 },
        });

        startY = doc.lastAutoTable.finalY + 5;

        appData.locations.forEach((loc) => {
            doc.setFontSize(12);
            doc.text(`Location: ${loc.location}`, (doc.internal.pageSize.getWidth() / 2), startY, { align: 'center' });
            startY += 6;

            loc.tables.sort((a,b) => tableTitlesOrder.indexOf(a.title) - tableTitlesOrder.indexOf(b.title)).forEach((table) => {
                if (startY + 20 > doc.internal.pageSize.getHeight()) {
                    doc.addPage();
                    startY = 15;
                }
                const visibleRows = table.rows.map(row => row.map(cell => String(cell || '')));
                
                doc.setFontSize(10);
                doc.text(table.title, 14, startY);
                startY += 5;

                doc.autoTable({
                    head: [table.headers],
                    body: visibleRows,
                    startY: startY,
                    theme: 'grid',
                    styles: { fontSize: 5, cellPadding: 1, overflow: 'linebreak' },
                    headStyles: { fillColor: [22, 160, 133], textColor: 255, fontSize: 6 },
                });
                startY = doc.lastAutoTable.finalY + 5;
            });
        });
        doc.save(`${getCleanFileName()}_all_tables.pdf`);
    }

    function main() {
        const container = document.getElementById('main-content');
        container.innerHTML = '';
        initializeData();
        renderProjectDetails();
        renderTables();
    }
    
    document.addEventListener('DOMContentLoaded', main);

    </script>
</body>
</html>
